import{E as ve}from"./DAnKQ6pu.js";import{a5 as Z,aE as J,b4 as _e,a6 as fe,ab as he,b5 as ge,r as b,b6 as q,H as Y,aa as ye,ad as j,j as w,d as E,t as r,v as h,al as S,ag as I,M as t,an as L,af as D,A as k,aQ as be,b7 as xe,aj as we,as as ee,ao as Ce,b8 as $e,x as s,B as C,y,z as T,ak as ke,Q as Te,a_ as Ee,ah as Be,U as Ne,X as Ie,at as He,a as M,S as W,T as R,F as A,N as g,O as te,P as se,b9 as ae,ba as oe,u as Ve,W as U,ay as De,bb as F,Z as O,R as G,bc as Ae,bd as Ke,be as Pe,bf as Ue,bg as Oe}from"./eY1TCqrd.js";import{U as le,C as ne}from"./HEVJa2N9.js";import{u as ie}from"./GyoxEo3B.js";import{E as B}from"./BVfZ8Tvx.js";import"./lXTnVocZ.js";const X=c=>fe(c)||he(c)||ge(c),Se=Z({accordion:Boolean,modelValue:{type:J([Array,String,Number]),default:()=>_e([])}}),je={[le]:X,[ne]:X},de=Symbol("collapseContextKey"),Fe=(c,u)=>{const i=b(q(c.modelValue)),d=a=>{i.value=a;const o=c.accordion?i.value[0]:i.value;u(le,o),u(ne,o)},e=a=>{if(c.accordion)d([i.value[0]===a?"":a]);else{const o=[...i.value],_=o.indexOf(a);_>-1?o.splice(_,1):o.push(a),d(o)}};return Y(()=>c.modelValue,()=>i.value=q(c.modelValue),{deep:!0}),ye(de,{activeNames:i,handleItemClick:e}),{activeNames:i,setActiveNames:d}},Le=()=>{const c=j("collapse");return{rootKls:w(()=>c.b())}},Me=E({name:"ElCollapse"}),We=E({...Me,props:Se,emits:je,setup(c,{expose:u,emit:i}){const d=c,{activeNames:e,setActiveNames:a}=Fe(d,i),{rootKls:o}=Le();return u({activeNames:e,setActiveNames:a}),(_,n)=>(r(),h("div",{class:I(t(o))},[S(_.$slots,"default")],2))}});var Re=L(We,[["__file","collapse.vue"]]);const ze=E({name:"ElCollapseTransition"}),Qe=E({...ze,setup(c){const u=j("collapse-transition"),i=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},d={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height&&(e.dataset.elExistsHeight=e.style.height),e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){requestAnimationFrame(()=>{e.dataset.oldOverflow=e.style.overflow,e.dataset.elExistsHeight?e.style.maxHeight=e.dataset.elExistsHeight:e.scrollHeight!==0?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"})},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){i(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){i(e)},leaveCancelled(e){i(e)}};return(e,a)=>(r(),D(we,be({name:t(u).b()},xe(d)),{default:k(()=>[S(e.$slots,"default")]),_:3},16,["name"]))}});var qe=L(Qe,[["__file","collapse-transition.vue"]]);const Ge=ee(qe),Xe=Z({title:{type:String,default:""},name:{type:J([String,Number]),default:void 0},disabled:Boolean}),Ze=c=>{const u=Ce(de),{namespace:i}=j("collapse"),d=b(!1),e=b(!1),a=$e(),o=w(()=>a.current++),_=w(()=>{var l;return(l=c.name)!=null?l:`${i.value}-id-${a.prefix}-${t(o)}`}),n=w(()=>u==null?void 0:u.activeNames.value.includes(t(_)));return{focusing:d,id:o,isActive:n,handleFocus:()=>{setTimeout(()=>{e.value?e.value=!1:d.value=!0},50)},handleHeaderClick:()=>{c.disabled||(u==null||u.handleItemClick(t(_)),d.value=!1,e.value=!0)},handleEnterClick:()=>{u==null||u.handleItemClick(t(_))}}},Je=(c,{focusing:u,isActive:i,id:d})=>{const e=j("collapse"),a=w(()=>[e.b("item"),e.is("active",t(i)),e.is("disabled",c.disabled)]),o=w(()=>[e.be("item","header"),e.is("active",t(i)),{focusing:t(u)&&!c.disabled}]),_=w(()=>[e.be("item","arrow"),e.is("active",t(i))]),n=w(()=>e.be("item","wrap")),m=w(()=>e.be("item","content")),p=w(()=>e.b(`content-${t(d)}`)),v=w(()=>e.b(`head-${t(d)}`));return{arrowKls:_,headKls:o,rootKls:a,itemWrapperKls:n,itemContentKls:m,scopedContentId:p,scopedHeadId:v}},Ye=E({name:"ElCollapseItem"}),et=E({...Ye,props:Xe,setup(c,{expose:u}){const i=c,{focusing:d,id:e,isActive:a,handleFocus:o,handleHeaderClick:_,handleEnterClick:n}=Ze(i),{arrowKls:m,headKls:p,rootKls:v,itemWrapperKls:l,itemContentKls:H,scopedContentId:V,scopedHeadId:K}=Je(i,{focusing:d,isActive:a,id:e});return u({isActive:a}),(N,z)=>(r(),h("div",{class:I(t(v))},[s("button",{id:t(K),class:I(t(p)),"aria-expanded":t(a),"aria-controls":t(V),"aria-describedby":t(V),tabindex:N.disabled?-1:0,type:"button",onClick:t(_),onKeydown:Ee(Be(t(n),["stop","prevent"]),["space","enter"]),onFocus:t(o),onBlur:x=>d.value=!1},[S(N.$slots,"title",{},()=>[C(y(N.title),1)]),T(t(Te),{class:I(t(m))},{default:k(()=>[T(t(ke))]),_:1},8,["class"])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),T(t(Ge),null,{default:k(()=>[Ne(s("div",{id:t(V),role:"region",class:I(t(l)),"aria-hidden":!t(a),"aria-labelledby":t(K)},[s("div",{class:I(t(H))},[S(N.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[Ie,t(a)]])]),_:3})],2))}});var ce=L(et,[["__file","collapse-item.vue"]]);const re=ee(Re,{CollapseItem:ce}),ue=He(ce),tt={key:0},st={key:0,class:"text-center"},at={key:1},ot={class:"flex w-full justify-between px-1 lg:px-2 lg:text-sm"},lt={class:"flex items-center px-2"},nt={class:"w-24 phone:w-32"},it=["src","alt"],dt={class:"ml-4 text-sm lg:text-base"},ct=s("span",{class:"font-bold"},"品項",-1),rt=s("span",{class:"font-bold"},"價錢",-1),ut=s("span",{class:"font-bold"},"時間",-1),mt={key:0},pt=s("span",{class:"font-bold"},"狀態",-1),vt=E({__name:"OrderList",setup(c){const{getImageUrl:u}=ie(),{$firebaseDb:i}=M(),d=i,e=W(),a=b();R(e,n=>{n?a.value=n:a.value=null});const o=b(),_=async n=>{if(n){const m=ae(d,"users",n.uid,"orders"),p=await oe(m);o.value=p.docs.map(v=>({id:v.id,...v.data()}))}};return A(()=>{a.value&&_(a.value)}),A(()=>{o.value&&(o.value=o.value.sort((n,m)=>{const p=new Date(n.orderTime);return new Date(m.orderTime).getTime()-p.getTime()}))}),(n,m)=>{const p=ue,v=re;return t(o)?(r(),h("div",tt,[t(o).length?g("",!0):(r(),h("div",st,"查無已報名活動")),t(o).length?(r(),h("div",at,[(r(!0),h(te,null,se(t(o),l=>(r(),h("div",{key:l.id},[T(v,null,{default:k(()=>[T(p,null,{title:k(()=>[s("div",ot,[s("div",null,y(l.ID),1),s("div",null,y(l.orderTime),1)])]),default:k(()=>[s("div",lt,[s("div",nt,[s("img",{src:t(u)(`${l.source}.png`),alt:l.dessert},null,8,it)]),s("div",dt,[s("div",null,[ct,C(" : "+y(l.dessert),1)]),s("div",null,[rt,C(" : $ "+y(l.price),1)]),s("div",null,[ut,C(" : "+y(l.date)+" "+y(l.time),1)]),l.birthday==="是"?(r(),h("div",mt,"加購生日蛋糕")):g("",!0),s("div",null,[pt,C(" : "+y(l.state),1)])])])]),_:2},1024)]),_:2},1024)]))),128))])):g("",!0)])):g("",!0)}}}),_t={key:0},ft={key:0,class:"text-center"},ht={key:1},gt={class:"flex w-full justify-between px-1 lg:px-2 lg:text-sm"},yt={class:"flex items-center px-2"},bt={class:"w-24 phone:w-32"},xt=["src","alt"],wt={class:"ml-4 text-sm lg:text-base"},Ct=s("span",{class:"font-bold"},"活動",-1),$t=s("span",{class:"font-bold"},"時間",-1),kt=s("span",{class:"font-bold"},"狀態",-1),Tt=E({__name:"ActivityList",setup(c){const{getImageUrl:u}=ie(),{$firebaseDb:i}=M(),d=i,e=W(),a=b();R(e,n=>{n?a.value=n:a.value=null});const o=b(),_=async n=>{if(n){const m=ae(d,"users",n.uid,"activities"),p=await oe(m);o.value=p.docs.map(v=>({id:v.id,...v.data()}))}};return A(()=>{a.value&&_(a.value)}),A(()=>{o.value&&(o.value=o.value.sort((n,m)=>{const p=new Date(n.orderTime);return new Date(m.orderTime).getTime()-p.getTime()}))}),(n,m)=>{const p=ue,v=re;return t(o)?(r(),h("div",_t,[t(o).length?g("",!0):(r(),h("div",ft,"查無已報名活動")),t(o).length?(r(),h("div",ht,[(r(!0),h(te,null,se(t(o),l=>(r(),h("div",{key:l.id},[T(v,null,{default:k(()=>[T(p,null,{title:k(()=>[s("div",gt,[s("div",null,y(l.ID),1),s("div",null,y(l.orderTime),1)])]),default:k(()=>[s("div",yt,[s("div",bt,[s("img",{src:t(u)(`${l.type}.png`),alt:l.name},null,8,xt)]),s("div",wt,[s("div",null,[Ct,C(" : "+y(l.name),1)]),s("div",null,[$t,C(" : "+y(l.date)+" "+y(l.time),1)]),s("div",null,[kt,C(" : "+y(l.state),1)])])])]),_:2},1024)]),_:2},1024)]))),128))])):g("",!0)])):g("",!0)}}}),Et={key:0,class:"m-auto mb-[150px] px-3 md:w-4/5 lg:max-w-[1000px]"},Bt={class:"mt-3 text-center text-2xl font-bold lg:text-start"},Nt={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},It={class:"flex justify-between"},Ht=s("div",{class:"text-lg font-bold"},"個人資料",-1),Vt={class:"my-2 flex font-bold"},Dt={class:"mx-3"},At={class:"my-2 flex font-bold"},Kt={class:"mx-3"},Pt={key:0,class:"mr-3 text-red-500"},Ut={class:"my-2 flex font-bold"},Ot={class:"mx-3"},St={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},jt=s("div",{class:"mb-2 flex justify-between"},[s("div",{class:"text-lg font-bold"},"處理中訂單"),s("div",{class:"cursor-pointer"},"訂單管理")],-1),Ft={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},Lt=s("div",{class:"mb-2 flex justify-between"},[s("div",{class:"text-lg font-bold"},"已報名活動"),s("div",{class:"cursor-pointer"},"活動管理")],-1),Gt=E({__name:"user",setup(c){const u=Ve(),{$firebaseDb:i}=M(),d=i,e=W(),a=b();R(e,x=>{x?a.value=x:a.value=null});const o=b(),_=async x=>{if(x){const f=await Oe(O(d,"users",x.uid));f.exists()&&(o.value=f.data())}},n=b(),m=b(),p=b(),v=b(),l=b(!1),H=b();function V(){o.value.email===a.value.email?H.value=!0:H.value=!1}A(()=>{a.value&&_(a.value)}),Y(o,x=>{n.value=x.userName,m.value=x.email,p.value=x.phone,V()});async function K(){await De(a.value,{displayName:n.value}),F(O(d,"users",a.value.uid),{userName:n.value}),G({message:"姓名更新成功",type:"success"}),_(a.value)}async function N(){await F(O(d,"users",a.value.uid),{phone:p.value}),G({message:"電話號碼更新成功",type:"success"}),_(a.value)}async function z(){if(a.value)if(m.value===o.value.email)B.alert("新信箱不得與舊信箱相同","提示",{confirmButtonText:"確認"});else{const x=Ae.credential(a.value.email,v.value);try{await Ke(a.value,x),await Pe(a.value,m.value),B.alert("驗證信已成功發送，請查看您的新信箱","提示",{confirmButtonText:"確認"}).then(()=>{F(O(d,"users",a.value.uid),{email:m.value}),B.alert("請在驗證新信箱後再重新登入","提示",{confirmButtonText:"確認"}).then(()=>{Ue(e),u.push({path:"/member"})})}).catch(()=>{})}catch(f){f.code==="auth/missing-password"&&B.alert("密碼不得為空","提示",{confirmButtonText:"確認"}),f.code==="auth/invalid-credential"&&B.alert("密碼錯誤","提示",{confirmButtonText:"確認"}),f.code==="auth/missing-new-email"&&B.alert("信箱不得為空","提示",{confirmButtonText:"確認"}),f.code==="auth/invalid-new-email"&&B.alert("信箱格式錯誤","提示",{confirmButtonText:"確認"})}}}return(x,f)=>{var Q;const P=ve,me=vt,pe=Tt;return t(a)?(r(),h("div",Et,[s("div",Bt,y((Q=t(a))==null?void 0:Q.displayName)+"，歡迎回來 ",1),s("div",Nt,[s("div",It,[Ht,t(l)?g("",!0):(r(),h("div",{key:0,class:"cursor-pointer",onClick:f[0]||(f[0]=$=>l.value=!0)},"更改")),t(l)?(r(),h("div",{key:1,class:"cursor-pointer",onClick:f[1]||(f[1]=$=>l.value=!1)},"取消")):g("",!0)]),s("div",Vt,[C(" 名字"),s("span",Dt,y(t(o).userName),1),t(l)?(r(),h("div",{key:0,class:"cursor-pointer",onClick:K},"儲存")):g("",!0)]),t(l)?(r(),D(P,{key:0,modelValue:t(n),"onUpdate:modelValue":f[2]||(f[2]=$=>U(n)?n.value=$:null),placeholder:"名字"},null,8,["modelValue"])):g("",!0),s("div",At,[C(" 信箱"),s("span",Kt,y(t(o).email),1),t(H)?g("",!0):(r(),h("div",Pt,"尚未驗證")),t(l)?(r(),h("div",{key:1,class:"cursor-pointer",onClick:z},"儲存")):g("",!0)]),t(l)?(r(),D(P,{key:1,modelValue:t(m),"onUpdate:modelValue":f[3]||(f[3]=$=>U(m)?m.value=$:null),placeholder:"信箱"},null,8,["modelValue"])):g("",!0),t(l)?(r(),D(P,{key:2,modelValue:t(v),"onUpdate:modelValue":f[4]||(f[4]=$=>U(v)?v.value=$:null),placeholder:"請輸入密碼已進行驗證","show-password":"",class:"mt-1"},null,8,["modelValue"])):g("",!0),s("div",Ut,[C(" 電話"),s("span",Ot,y(t(o).phone),1),t(l)?(r(),h("div",{key:0,class:"cursor-pointer",onClick:N},"儲存")):g("",!0)]),t(l)?(r(),D(P,{key:3,modelValue:t(p),"onUpdate:modelValue":f[5]||(f[5]=$=>U(p)?p.value=$:null),placeholder:"電話"},null,8,["modelValue"])):g("",!0)]),s("div",St,[jt,T(me)]),s("div",Ft,[Lt,T(pe)])])):g("",!0)}}});export{Gt as default};
