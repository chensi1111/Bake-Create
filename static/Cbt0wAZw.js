import{E as fe}from"./D7J_64L4.js";import{a7 as oe,aF as le,b6 as he,a8 as be,ad as ge,b7 as ye,r as y,b8 as te,H as ne,ac as xe,af as j,j as k,d as T,t as c,v as f,an as S,ai as I,M as s,ap as z,ah as A,A as w,aR as $e,b9 as we,al as Ce,au as ie,aq as ke,ba as Te,x as t,B as x,y as h,z as C,am as Ee,Q as Be,b3 as Ne,aj as De,V as Ie,Y as He,av as Ve,a as F,T as L,U as M,F as N,N as b,O as W,P as q,bb as G,bc as Q,u as Ae,X as U,az as Ke,bd as R,$ as O,S as se,be as Pe,bf as Ue,bg as Oe,bh as Se,a1 as je}from"./eCvMLCrA.js";import{U as de,C as ce}from"./HEVJa2N9.js";import{u as re}from"./DiJq3-t6.js";import{E as B}from"./DQaRQUc-.js";import"./C_FUOAlw.js";import"./__HaK0sV.js";const ae=v=>be(v)||ge(v)||ye(v),Fe=oe({accordion:Boolean,modelValue:{type:le([Array,String,Number]),default:()=>he([])}}),Le={[de]:ae,[ce]:ae},ue=Symbol("collapseContextKey"),Me=(v,_)=>{const i=y(te(v.modelValue)),u=a=>{i.value=a;const o=v.accordion?i.value[0]:i.value;_(de,o),_(ce,o)},e=a=>{if(v.accordion)u([i.value[0]===a?"":a]);else{const o=[...i.value],r=o.indexOf(a);r>-1?o.splice(r,1):o.push(a),u(o)}};return ne(()=>v.modelValue,()=>i.value=te(v.modelValue),{deep:!0}),xe(ue,{activeNames:i,handleItemClick:e}),{activeNames:i,setActiveNames:u}},Re=()=>{const v=j("collapse");return{rootKls:k(()=>v.b())}},ze=T({name:"ElCollapse"}),We=T({...ze,props:Fe,emits:Le,setup(v,{expose:_,emit:i}){const u=v,{activeNames:e,setActiveNames:a}=Me(u,i),{rootKls:o}=Re();return _({activeNames:e,setActiveNames:a}),(r,n)=>(c(),f("div",{class:I(s(o))},[S(r.$slots,"default")],2))}});var qe=z(We,[["__file","collapse.vue"]]);const Ge=T({name:"ElCollapseTransition"}),Qe=T({...Ge,setup(v){const _=j("collapse-transition"),i=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},u={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height&&(e.dataset.elExistsHeight=e.style.height),e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){requestAnimationFrame(()=>{e.dataset.oldOverflow=e.style.overflow,e.dataset.elExistsHeight?e.style.maxHeight=e.dataset.elExistsHeight:e.scrollHeight!==0?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"})},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){i(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){i(e)},leaveCancelled(e){i(e)}};return(e,a)=>(c(),A(Ce,$e({name:s(_).b()},we(u)),{default:w(()=>[S(e.$slots,"default")]),_:3},16,["name"]))}});var Xe=z(Qe,[["__file","collapse-transition.vue"]]);const Ye=ie(Xe),Je=oe({title:{type:String,default:""},name:{type:le([String,Number]),default:void 0},disabled:Boolean}),Ze=v=>{const _=ke(ue),{namespace:i}=j("collapse"),u=y(!1),e=y(!1),a=Te(),o=k(()=>a.current++),r=k(()=>{var l;return(l=v.name)!=null?l:`${i.value}-id-${a.prefix}-${s(o)}`}),n=k(()=>_==null?void 0:_.activeNames.value.includes(s(r)));return{focusing:u,id:o,isActive:n,handleFocus:()=>{setTimeout(()=>{e.value?e.value=!1:u.value=!0},50)},handleHeaderClick:()=>{v.disabled||(_==null||_.handleItemClick(s(r)),u.value=!1,e.value=!0)},handleEnterClick:()=>{_==null||_.handleItemClick(s(r))}}},et=(v,{focusing:_,isActive:i,id:u})=>{const e=j("collapse"),a=k(()=>[e.b("item"),e.is("active",s(i)),e.is("disabled",v.disabled)]),o=k(()=>[e.be("item","header"),e.is("active",s(i)),{focusing:s(_)&&!v.disabled}]),r=k(()=>[e.be("item","arrow"),e.is("active",s(i))]),n=k(()=>e.be("item","wrap")),m=k(()=>e.be("item","content")),p=k(()=>e.b(`content-${s(u)}`)),d=k(()=>e.b(`head-${s(u)}`));return{arrowKls:r,headKls:o,rootKls:a,itemWrapperKls:n,itemContentKls:m,scopedContentId:p,scopedHeadId:d}},tt=T({name:"ElCollapseItem"}),st=T({...tt,props:Je,setup(v,{expose:_}){const i=v,{focusing:u,id:e,isActive:a,handleFocus:o,handleHeaderClick:r,handleEnterClick:n}=Ze(i),{arrowKls:m,headKls:p,rootKls:d,itemWrapperKls:l,itemContentKls:H,scopedContentId:V,scopedHeadId:K}=et(i,{focusing:u,isActive:a,id:e});return _({isActive:a}),(D,J)=>(c(),f("div",{class:I(s(d))},[t("button",{id:s(K),class:I(s(p)),"aria-expanded":s(a),"aria-controls":s(V),"aria-describedby":s(V),tabindex:D.disabled?-1:0,type:"button",onClick:s(r),onKeydown:Ne(De(s(n),["stop","prevent"]),["space","enter"]),onFocus:s(o),onBlur:Z=>u.value=!1},[S(D.$slots,"title",{},()=>[x(h(D.title),1)]),C(s(Be),{class:I(s(m))},{default:w(()=>[C(s(Ee))]),_:1},8,["class"])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),C(s(Ye),null,{default:w(()=>[Ie(t("div",{id:s(V),role:"region",class:I(s(l)),"aria-hidden":!s(a),"aria-labelledby":s(K)},[t("div",{class:I(s(H))},[S(D.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[He,s(a)]])]),_:3})],2))}});var me=z(st,[["__file","collapse-item.vue"]]);const X=ie(qe,{CollapseItem:me}),Y=Ve(me),at={key:0},ot={key:0,class:"text-center"},lt={key:1},nt={class:"flex w-full justify-between px-1 lg:px-2 lg:text-sm"},it={class:"flex items-center px-2"},dt={class:"w-24 phone:w-32"},ct=["src","alt"],rt={class:"ml-4 text-sm lg:text-base"},ut=t("span",{class:"font-bold"},"品項",-1),mt=t("span",{class:"font-bold"},"價錢",-1),pt=t("span",{class:"font-bold"},"時間",-1),_t={key:0,class:"font-bold"},vt=t("span",{class:"font-bold"},"狀態",-1),ft=T({__name:"OrderList",setup(v){const{getImageUrl:_}=re(),{$firebaseDb:i}=F(),u=i,e=L(),a=y();M(e,n=>{n?a.value=n:a.value=null});const o=y(),r=async n=>{if(n){const m=G(u,"users",n.uid,"orders"),p=await Q(m);o.value=p.docs.map(d=>({id:d.id,...d.data()}))}};return N(()=>{a.value&&r(a.value)}),N(()=>{o.value&&(o.value=o.value.sort((n,m)=>{const p=new Date(n.orderTime);return new Date(m.orderTime).getTime()-p.getTime()}))}),(n,m)=>{const p=Y,d=X;return s(o)?(c(),f("div",at,[s(o).length?b("",!0):(c(),f("div",ot,"查無已報名活動")),s(o).length?(c(),f("div",lt,[(c(!0),f(W,null,q(s(o),l=>(c(),f("div",{key:l.id},[C(d,{class:"border-b-2 border-t-0 border-black"},{default:w(()=>[C(p,null,{title:w(()=>[t("div",nt,[t("div",null,h(l.ID),1),t("div",null,h(l.orderTime),1)])]),default:w(()=>[t("div",it,[t("div",dt,[t("img",{src:s(_)(`${l.source}.png`),alt:l.dessert},null,8,ct)]),t("div",rt,[t("div",null,[ut,x(" : "+h(l.dessert),1)]),t("div",null,[mt,x(" : $ "+h(l.price),1)]),t("div",null,[pt,x(" : "+h(l.date)+" "+h(l.time),1)]),l.birthday==="是"?(c(),f("div",_t,"加購生日蛋糕")):b("",!0),t("div",null,[vt,x(" : "+h(l.state),1)])])])]),_:2},1024)]),_:2},1024)]))),128))])):b("",!0)])):b("",!0)}}}),ht={key:0},bt={key:0,class:"text-center"},gt={key:1},yt={class:"flex w-full justify-between px-1 lg:px-2 lg:text-sm"},xt={class:"flex items-center px-2"},$t={class:"w-24 phone:w-32"},wt=["src","alt"],Ct={class:"ml-4 text-sm lg:text-base"},kt=t("span",{class:"font-bold"},"活動",-1),Tt=t("span",{class:"font-bold"},"時間",-1),Et=t("span",{class:"font-bold"},"狀態",-1),Bt=T({__name:"ActivityList",setup(v){const{getImageUrl:_}=re(),{$firebaseDb:i}=F(),u=i,e=L(),a=y();M(e,n=>{n?a.value=n:a.value=null});const o=y(),r=async n=>{if(n){const m=G(u,"users",n.uid,"activities"),p=await Q(m);o.value=p.docs.map(d=>({id:d.id,...d.data()}))}};return N(()=>{a.value&&r(a.value)}),N(()=>{o.value&&(o.value=o.value.sort((n,m)=>{const p=new Date(n.orderTime);return new Date(m.orderTime).getTime()-p.getTime()}))}),(n,m)=>{const p=Y,d=X;return s(o)?(c(),f("div",ht,[s(o).length?b("",!0):(c(),f("div",bt,"查無已報名活動")),s(o).length?(c(),f("div",gt,[(c(!0),f(W,null,q(s(o),l=>(c(),f("div",{key:l.id},[C(d,{class:"border-b-2 border-t-0 border-black"},{default:w(()=>[C(p,null,{title:w(()=>[t("div",yt,[t("div",null,h(l.ID),1),t("div",null,h(l.orderTime),1)])]),default:w(()=>[t("div",xt,[t("div",$t,[t("img",{src:s(_)(`${l.type}.png`),alt:l.name},null,8,wt)]),t("div",Ct,[t("div",null,[kt,x(" : "+h(l.name),1)]),t("div",null,[Tt,x(" : "+h(l.date)+" "+h(l.time),1)]),t("div",null,[Et,x(" : "+h(l.state),1)])])])]),_:2},1024)]),_:2},1024)]))),128))])):b("",!0)])):b("",!0)}}}),Nt={key:0},Dt={key:0,class:"text-center"},It={key:1},Ht={class:"flex w-full justify-between px-1 lg:px-2 lg:text-sm"},Vt={class:"flex items-center px-2"},At={class:"ml-4 text-sm lg:text-base"},Kt=t("span",{class:"font-bold"},"時間",-1),Pt=t("span",{class:"font-bold"},"人數",-1),Ut=t("span",{class:"font-bold"},"時數",-1),Ot=t("span",{class:"font-bold"},"狀態",-1),St=T({__name:"RentList",setup(v){const{$firebaseDb:_}=F(),i=_,u=L(),e=y();M(u,r=>{r?e.value=r:e.value=null});const a=y(),o=async r=>{if(r){const n=G(i,"users",r.uid,"rents"),m=await Q(n);a.value=m.docs.map(p=>({id:p.id,...p.data()}))}};return N(()=>{e.value&&o(e.value)}),N(()=>{a.value&&(a.value=a.value.sort((r,n)=>{const m=new Date(r.orderTime);return new Date(n.orderTime).getTime()-m.getTime()}))}),(r,n)=>{const m=Y,p=X;return s(a)?(c(),f("div",Nt,[s(a).length?b("",!0):(c(),f("div",Dt,"查無租借訂單")),s(a).length?(c(),f("div",It,[(c(!0),f(W,null,q(s(a),d=>(c(),f("div",{key:d.id},[C(p,{class:"border-b-2 border-t-0 border-black"},{default:w(()=>[C(m,null,{title:w(()=>[t("div",Ht,[t("div",null,h(d.ID),1),t("div",null,h(d.orderTime),1)])]),default:w(()=>[t("div",Vt,[t("div",At,[t("div",null,[Kt,x(" : "+h(d.date)+" "+h(d.time),1)]),t("div",null,[Pt,x(" : "+h(d.people)+"人",1)]),t("div",null,[Ut,x(" : "+h(d.hours)+"小時",1)]),t("div",null,[Ot,x(" : "+h(d.state),1)])])])]),_:2},1024)]),_:2},1024)]))),128))])):b("",!0)])):b("",!0)}}}),jt={key:0,class:"m-auto mb-[150px] px-3 md:w-4/5 lg:max-w-[1000px]"},Ft={class:"mt-3 text-center text-2xl font-bold lg:text-start"},Lt={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},Mt={class:"flex justify-between"},Rt=t("div",{class:"text-lg font-bold"},"個人資料",-1),zt={class:"my-2 flex font-bold"},Wt={class:"mx-3"},qt={class:"my-2 flex font-bold"},Gt={class:"mx-3"},Qt={key:0,class:"mr-3 text-red-500"},Xt={class:"my-2 flex font-bold"},Yt={class:"mx-3"},Jt={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},Zt=t("div",{class:"text-lg font-bold"},"處理中訂單",-1),es={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},ts=t("div",{class:"mb-2 flex justify-between"},[t("div",{class:"text-lg font-bold"},"已報名活動"),t("div",{class:"cursor-pointer"},"活動管理")],-1),ss={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},as=t("div",{class:"mb-2 flex justify-between"},[t("div",{class:"text-lg font-bold"},"已預約場地"),t("div",{class:"cursor-pointer"},"租借管理")],-1),us=T({__name:"index",setup(v){const _=Ae(),{$firebaseDb:i}=F(),u=i,e=L(),a=y();M(e,$=>{$?a.value=$:a.value=null});const o=y(),r=async $=>{if($){const g=await je(O(u,"users",$.uid));g.exists()&&(o.value=g.data())}},n=y(),m=y(),p=y(),d=y(),l=y(!1),H=y();function V(){o.value.email===a.value.email?H.value=!0:H.value=!1}N(()=>{a.value&&r(a.value)}),ne(o,$=>{n.value=$.userName,m.value=$.email,p.value=$.phone,V()});async function K(){await Ke(a.value,{displayName:n.value}),R(O(u,"users",a.value.uid),{userName:n.value}),se({message:"姓名更新成功",type:"success"}),r(a.value)}async function D(){await R(O(u,"users",a.value.uid),{phone:p.value}),se({message:"電話號碼更新成功",type:"success"}),r(a.value)}async function J(){if(a.value)if(m.value===o.value.email)B.alert("新信箱不得與舊信箱相同","提示",{confirmButtonText:"確認"});else{const $=Pe.credential(a.value.email,d.value);try{await Ue(a.value,$),await Oe(a.value,m.value),B.alert("驗證信已成功發送，請查看您的新信箱","提示",{confirmButtonText:"確認"}).then(()=>{R(O(u,"users",a.value.uid),{email:m.value}),B.alert("請在驗證新信箱後再重新登入","提示",{confirmButtonText:"確認"}).then(()=>{Se(e),_.push({path:"/member"})})}).catch(()=>{})}catch(g){g.code==="auth/missing-password"&&B.alert("密碼不得為空","提示",{confirmButtonText:"確認"}),g.code==="auth/invalid-credential"&&B.alert("密碼錯誤","提示",{confirmButtonText:"確認"}),g.code==="auth/missing-new-email"&&B.alert("信箱不得為空","提示",{confirmButtonText:"確認"}),g.code==="auth/invalid-new-email"&&B.alert("信箱格式錯誤","提示",{confirmButtonText:"確認"})}}}function Z(){_.push({path:"/user/manage"})}return($,g)=>{var ee;const P=fe,pe=ft,_e=Bt,ve=St;return s(a)?(c(),f("div",jt,[t("div",Ft,h((ee=s(a))==null?void 0:ee.displayName)+"，歡迎回來 ",1),t("div",Lt,[t("div",Mt,[Rt,s(l)?b("",!0):(c(),f("div",{key:0,class:"cursor-pointer",onClick:g[0]||(g[0]=E=>l.value=!0)},"更改")),s(l)?(c(),f("div",{key:1,class:"cursor-pointer",onClick:g[1]||(g[1]=E=>l.value=!1)},"取消")):b("",!0)]),t("div",zt,[x(" 名字"),t("span",Wt,h(s(o).userName),1),s(l)?(c(),f("div",{key:0,class:"cursor-pointer",onClick:K},"儲存")):b("",!0)]),s(l)?(c(),A(P,{key:0,modelValue:s(n),"onUpdate:modelValue":g[2]||(g[2]=E=>U(n)?n.value=E:null),placeholder:"名字"},null,8,["modelValue"])):b("",!0),t("div",qt,[x(" 信箱"),t("span",Gt,h(s(o).email),1),s(H)?b("",!0):(c(),f("div",Qt,"尚未驗證")),s(l)?(c(),f("div",{key:1,class:"cursor-pointer",onClick:J},"儲存")):b("",!0)]),s(l)?(c(),A(P,{key:1,modelValue:s(m),"onUpdate:modelValue":g[3]||(g[3]=E=>U(m)?m.value=E:null),placeholder:"信箱"},null,8,["modelValue"])):b("",!0),s(l)?(c(),A(P,{key:2,modelValue:s(d),"onUpdate:modelValue":g[4]||(g[4]=E=>U(d)?d.value=E:null),placeholder:"請輸入密碼已進行驗證","show-password":"",class:"mt-1"},null,8,["modelValue"])):b("",!0),t("div",Xt,[x(" 電話"),t("span",Yt,h(s(o).phone),1),s(l)?(c(),f("div",{key:0,class:"cursor-pointer",onClick:D},"儲存")):b("",!0)]),s(l)?(c(),A(P,{key:3,modelValue:s(p),"onUpdate:modelValue":g[5]||(g[5]=E=>U(p)?p.value=E:null),placeholder:"電話"},null,8,["modelValue"])):b("",!0)]),t("div",Jt,[t("div",{class:"mb-2 flex justify-between"},[Zt,t("div",{class:"cursor-pointer",onClick:Z},"訂單管理")]),C(pe)]),t("div",es,[ts,C(_e)]),t("div",ss,[as,C(ve)])])):b("",!0)}}});export{us as default};
