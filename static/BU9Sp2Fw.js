import{u as X}from"./CmwSIr80.js";import{u as G}from"./Bf4DGcnN.js";import{d as J,a as K,T as Q,r as d,U as tt,F as et,j as M,u as st,H as at,t as D,v as $,x as t,M as o,y as h,V as n,W as V,X as g,Y as S,Z as ot,O as lt,P as nt,aU as N,B as m,z as P,$ as A,a0 as dt,a1 as rt}from"./BmZGITcj.js";import{n as it}from"./DP16PUbO.js";import{V as z}from"./D1wAb5By.js";const ut={class:"px-3"},ct={class:"m-auto mt-4 max-w-[1000px] rounded-md bg-pink-100 p-2 shadow-lg lg:px-10"},mt={class:"md:flex"},pt={class:"flex overflow-hidden rounded-md md:order-2 md:w-2/5 md:flex-col md:justify-center"},vt={class:"w-1/2 md:w-full"},ft=["src","alt"],ht={class:"flex w-1/2 flex-col justify-center bg-white pl-3 md:w-full"},gt={class:"mb-1 text-lg font-bold md:mt-3 lg:text-xl"},_t={class:"font-bold"},xt={class:"font-bold"},yt={class:"mt-3 md:mr-4 md:w-3/5"},bt={class:"mb-2"},St=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("姓名")],-1),wt={class:"text-sm text-red-800"},Dt={class:"mb-2"},$t=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("電話")],-1),Vt={class:"text-sm text-red-800"},kt={class:"mb-2"},Ut=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("信箱")],-1),Ct={class:"mb-2"},Tt=t("div",{class:"font-bold"},"甜點品項",-1),Mt=["value"],Nt={class:"mb-2"},Pt=t("div",{class:"font-bold"},"加購生日蛋糕",-1),At={class:"mb-2"},zt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("預約日期")],-1),Et={class:"text-sm text-red-800"},Ft={class:"mb-2"},Rt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("預約時間")],-1),Bt={class:"text-sm text-red-800"},Wt=J({__name:"information",setup(It){const{getImageUrl:E}=X(),l=G(),{$firebaseDb:F}=K(),k=F,R=Q(),_=d();tt(R,s=>{s?_.value=s:_.value=null});const x=d(),B=async s=>{if(s){const e=await rt(A(k,"users",s.uid));e.exists()&&(x.value=e.data())}},p=d(l.productName),r=d(),i=d(),u=d(),c=d(),v=d();et(()=>{_.value&&B(_.value),x.value&&(r.value=x.value.userName,i.value=x.value.phone,u.value=x.value.email)});function I(){const s=new Date,e=new Date(s);e.setDate(s.getDate()+1);const a=e.getFullYear(),y=String(e.getMonth()+1).padStart(2,"0"),b=String(e.getDate()).padStart(2,"0");return`${a}-${y}-${b}`}function Y(){const s=new Date,e=new Date(s);e.setDate(s.getDate()+31);const a=e.getFullYear(),y=String(e.getMonth()+1).padStart(2,"0"),b=String(e.getDate()).padStart(2,"0");return`${a}-${y}-${b}`}const Z=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,f=d(!1);function j(s){return Z.test(s)}const w=M(()=>u.value?j(u.value)?void 0:"請輸入正確格式":"信箱為必填"),U=st();function H(){U.go(-1)}at(p,s=>{const e=l.allProducts.find(a=>a.name===s);e&&(l.productName=e.name,l.productPrice=e.price,l.productTime=e.time,l.productSource=e.source)});function L(){const s=new Date,e=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),y=String(s.getDate()).padStart(2,"0"),b=String(s.getHours()).padStart(2,"0"),q=String(s.getMinutes()).padStart(2,"0"),O=String(s.getSeconds()).padStart(2,"0");return`${e}-${a}-${y}T${b}:${q}:${O}`}function C(s){return new Date(s).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})}function T(s){const e=String(s.hours).padStart(2,"0"),a=String(s.minutes).padStart(2,"0");return`${e}:${a}`}function W(){if(r.value&&i.value&&!w.value&&c.value){const s=it(10),e=M(()=>l.birthdayCake?"是":"否"),a=A(k,"users",_.value.uid,"orders",s);dt(a,{name:r.value,phone:i.value,mail:u.value,date:C(c.value),time:T(v.value),dessert:p.value,birthday:e.value,ID:s,source:l.productSource,price:l.productPrice,orderTime:L(),state:"訂單處理中"}).then(()=>{U.push({path:"/order/complete",query:{name:r.value,phone:i.value,mail:u.value,date:C(c.value),time:T(v.value),dessert:p.value,birthday:e.value,ID:s}})})}else f.value=!0}return(s,e)=>(D(),$("div",ut,[t("div",ct,[t("div",mt,[t("div",pt,[t("div",vt,[t("img",{src:o(E)(`${o(l).productSource}.png`),alt:o(l).productName},null,8,ft)]),t("div",ht,[t("div",gt,h(o(l).productName),1),t("div",_t,"時長 : "+h(o(l).productTime)+"hr",1),t("div",xt,"價格 : $ "+h(o(l).productPrice),1)])]),t("div",yt,[t("div",bt,[St,n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>g(r)?r.value=a:null),type:"text",placeholder:"請輸入姓名",class:"my-1 w-full py-1 pl-2"},null,512),[[V,o(r)]]),n(t("div",wt,"姓名為必填",512),[[S,!o(r)&&o(f)]])]),t("div",Dt,[$t,n(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>g(i)?i.value=a:null),type:"text",placeholder:"請輸入電話",class:"my-1 w-full py-1 pl-2"},null,512),[[V,o(i)]]),n(t("div",Vt,"電話為必填",512),[[S,!o(i)&&o(f)]])]),t("div",kt,[Ut,n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>g(u)?u.value=a:null),type:"text",placeholder:"請輸入信箱",class:"my-1 w-full py-1 pl-2"},null,512),[[V,o(u)]]),n(t("div",{class:"text-sm text-red-800"},h(o(w)),513),[[S,o(w)&&o(f)]])]),t("div",Ct,[Tt,n(t("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>g(p)?p.value=a:null),class:"my-1 w-full py-1 pl-2"},[(D(!0),$(lt,null,nt(o(l).allProducts,a=>(D(),$("option",{key:a.name,value:a.name},[t("div",null,h(a.name)+" - $"+h(a.price),1)],8,Mt))),128))],512),[[ot,o(p)]])]),t("div",Nt,[Pt,t("label",null,[n(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>o(l).birthdayCake=a),type:"radio",name:"birthdayCake",value:"true"},null,512),[[N,o(l).birthdayCake]]),m(" 是 ")]),t("label",null,[n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o(l).birthdayCake=a),type:"radio",name:"birthdayCake",value:"false"},null,512),[[N,o(l).birthdayCake]]),m(" 否 ")])]),t("div",At,[zt,P(o(z),{modelValue:o(c),"onUpdate:modelValue":e[6]||(e[6]=a=>g(c)?c.value=a:null),"enable-time-picker":!1,"min-date":I(),"max-date":Y(),placeholder:"選擇預約日期"},null,8,["modelValue","min-date","max-date"]),n(t("div",Et,"日期為必填",512),[[S,!o(c)&&o(f)]])]),t("div",Ft,[Rt,P(o(z),{modelValue:o(v),"onUpdate:modelValue":e[7]||(e[7]=a=>g(v)?v.value=a:null),"time-picker":"","min-time":{hours:7},"max-time":{hours:18},"start-time":{hours:8,minutes:0},"minutes-increment":"15","minutes-grid-increment":"15",placeholder:"選擇預約時間"},null,8,["modelValue"]),n(t("div",Bt,"時間為必填",512),[[S,!o(v)&&o(f)]])])])]),t("div",{class:"flex justify-center"},[t("div",{class:"my-3 mr-4 w-fit cursor-pointer rounded-sm bg-gray-100 px-2 py-1 text-black",onClick:H}," 上一步 "),t("div",{class:"my-3 w-fit cursor-pointer rounded-sm bg-amber-800 px-2 py-1 text-white",onClick:W}," 下一步 ")])])]))}});export{Wt as default};
