import{u as Z}from"./DiJq3-t6.js";import{u as z}from"./-YcyciFu.js";import{d as F,a as H,T as O,r as d,U as Y,F as q,j as L,u as P,H as W,t as h,v as x,x as t,M as i,y as r,V as u,W as g,X as y,Y as w,Z as X,O as G,P as J,B as b,$ as N,a0 as K,a1 as Q}from"./eCvMLCrA.js";import{n as tt}from"./DP16PUbO.js";const et={class:"px-3"},st={class:"m-auto mt-4 max-w-[1000px] rounded-md bg-pink-100 p-2 shadow-lg lg:px-10"},at={class:"md:flex"},it={class:"flex overflow-hidden rounded-md md:order-2 md:w-2/5 md:flex-col md:justify-center"},ot={class:"w-1/3 sm:w-1/2 md:w-full"},lt=["src","alt"],nt={class:"flex w-2/3 flex-col justify-center bg-white py-1 pl-3 text-sm phone:text-base sm:w-1/2 md:w-full"},ct={class:"font-bold"},dt={class:"font-bold"},rt={class:"font-bold"},ut={class:"mt-3 md:mr-4 md:w-3/5"},vt={class:"mb-2"},mt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),b("姓名")],-1),pt={class:"text-sm text-red-800"},ft={class:"mb-2"},yt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),b("電話")],-1),_t={class:"text-sm text-red-800"},ht={class:"mb-2"},xt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),b("信箱")],-1),gt={class:"mb-2"},wt=t("div",{class:"font-bold"},"活動名稱",-1),bt=["value"],At=F({__name:"information",setup(St){const{getImageUrl:T}=Z(),a=z(),{$firebaseDb:$}=H(),S=$,A=O(),v=d();Y(A,e=>{e?v.value=e:v.value=null});const m=d(),U=async e=>{if(e){const s=await Q(N(S,"users",e.uid));s.exists()&&(m.value=s.data())}},l=d(),n=d(),c=d(),p=d(a.activityName);q(()=>{v.value&&U(v.value),m.value&&(l.value=m.value.userName,n.value=m.value.phone,c.value=m.value.email)});const k=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,f=d(!1);function V(e){return k.test(e)}const _=L(()=>c.value?V(c.value)?void 0:"請輸入正確格式":"信箱為必填"),D=P();function C(){D.go(-1)}W(p,e=>{const s=a.activities.find(o=>o.name===e);s&&(a.activityName=s.name,a.activityDate=s.date,a.activityTime=s.time,a.activitySource=s.type)});function E(){const e=new Date,s=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),j=String(e.getDate()).padStart(2,"0"),B=String(e.getHours()).padStart(2,"0"),I=String(e.getMinutes()).padStart(2,"0"),R=String(e.getSeconds()).padStart(2,"0");return`${s}-${o}-${j}T${B}:${I}:${R}`}function M(){if(l.value&&n.value&&!_.value&&p.value){const e=tt(10),s=N(S,"users",v.value.uid,"activities",e);K(s,{name:l.value,phone:n.value,mail:c.value,ID:e,activity:a.activityName,date:a.activityDate,time:a.activityTime,type:a.activitySource,orderTime:E(),state:"報名成功"}).then(()=>{D.push({path:"/activity/signUp/complete",query:{name:l.value,phone:n.value,mail:c.value,ID:e,activity:a.activityName,date:a.activityDate,time:a.activityTime}})})}else f.value=!0}return(e,s)=>(h(),x("div",et,[t("div",st,[t("div",at,[t("div",it,[t("div",ot,[t("img",{src:i(T)(`${i(a).activitySource}.png`),alt:i(a).activityName},null,8,lt)]),t("div",nt,[t("div",ct,"活動名稱 :"+r(i(a).activityName),1),t("div",dt,"活動日期 :"+r(i(a).activityDate),1),t("div",rt,"活動時間 :"+r(i(a).activityTime),1)])]),t("div",ut,[t("div",vt,[mt,u(t("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>y(l)?l.value=o:null),type:"text",placeholder:"請輸入姓名",class:"my-1 w-full py-1 pl-2"},null,512),[[g,i(l)]]),u(t("div",pt,"姓名為必填",512),[[w,!i(l)&&i(f)]])]),t("div",ft,[yt,u(t("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>y(n)?n.value=o:null),type:"text",placeholder:"請輸入電話",class:"my-1 w-full py-1 pl-2"},null,512),[[g,i(n)]]),u(t("div",_t,"電話為必填",512),[[w,!i(n)&&i(f)]])]),t("div",ht,[xt,u(t("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>y(c)?c.value=o:null),type:"text",placeholder:"請輸入信箱",class:"my-1 w-full py-1 pl-2"},null,512),[[g,i(c)]]),u(t("div",{class:"text-sm text-red-800"},r(i(_)),513),[[w,i(_)&&i(f)]])]),t("div",gt,[wt,u(t("select",{"onUpdate:modelValue":s[3]||(s[3]=o=>y(p)?p.value=o:null),class:"my-1 w-full py-1 pl-2"},[(h(!0),x(G,null,J(i(a).activitiesNow,o=>(h(),x("option",{key:o.name,value:o.name},[t("div",null,r(o.name)+" - "+r(o.date)+"-"+r(o.time),1)],8,bt))),128))],512),[[X,i(p)]])])])]),t("div",{class:"flex justify-center"},[t("div",{class:"my-3 mr-4 w-fit cursor-pointer rounded-sm bg-gray-100 px-2 py-1 text-black",onClick:C}," 上一步 "),t("div",{class:"my-3 w-fit cursor-pointer rounded-sm bg-amber-800 px-2 py-1 text-white",onClick:M}," 下一步 ")])])]))}});export{At as default};
