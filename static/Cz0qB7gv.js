import{E as ve}from"./BwtHOQoj.js";import{a6 as ae,aE as oe,b5 as fe,a7 as he,ac as be,b6 as ge,r as y,b7 as ee,H as le,ab as ye,ae as j,j as k,d as T,t as c,v as f,al as S,ag as I,M as s,an as W,a1 as A,A as w,aQ as xe,b8 as $e,aj as we,as as ne,ao as Ce,b9 as ke,x as t,B as x,y as h,z as C,ak as Te,Q as Ee,b0 as Be,ah as Ne,U as De,X as Ie,at as He,a as L,S as F,T as M,F as N,N as b,O as z,P as Q,ba as q,bb as G,u as Ve,W as U,ay as Ae,bc as R,Z as O,R as te,bd as Ke,be as Pe,bf as Ue,bg as Oe,bh as Se}from"./DyyCZs6m.js";import{U as ie,C as de}from"./HEVJa2N9.js";import{u as ce}from"./BDTCjVus.js";import{E as B}from"./B_442gpF.js";import"./CSDv52pG.js";import"./BZnxJvvq.js";const se=_=>he(_)||be(_)||ge(_),je=ae({accordion:Boolean,modelValue:{type:oe([Array,String,Number]),default:()=>fe([])}}),Le={[ie]:se,[de]:se},re=Symbol("collapseContextKey"),Fe=(_,v)=>{const i=y(ee(_.modelValue)),u=a=>{i.value=a;const o=_.accordion?i.value[0]:i.value;v(ie,o),v(de,o)},e=a=>{if(_.accordion)u([i.value[0]===a?"":a]);else{const o=[...i.value],r=o.indexOf(a);r>-1?o.splice(r,1):o.push(a),u(o)}};return le(()=>_.modelValue,()=>i.value=ee(_.modelValue),{deep:!0}),ye(re,{activeNames:i,handleItemClick:e}),{activeNames:i,setActiveNames:u}},Me=()=>{const _=j("collapse");return{rootKls:k(()=>_.b())}},Re=T({name:"ElCollapse"}),We=T({...Re,props:je,emits:Le,setup(_,{expose:v,emit:i}){const u=_,{activeNames:e,setActiveNames:a}=Fe(u,i),{rootKls:o}=Me();return v({activeNames:e,setActiveNames:a}),(r,n)=>(c(),f("div",{class:I(s(o))},[S(r.$slots,"default")],2))}});var ze=W(We,[["__file","collapse.vue"]]);const Qe=T({name:"ElCollapseTransition"}),qe=T({...Qe,setup(_){const v=j("collapse-transition"),i=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},u={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height&&(e.dataset.elExistsHeight=e.style.height),e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){requestAnimationFrame(()=>{e.dataset.oldOverflow=e.style.overflow,e.dataset.elExistsHeight?e.style.maxHeight=e.dataset.elExistsHeight:e.scrollHeight!==0?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"})},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){i(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){i(e)},leaveCancelled(e){i(e)}};return(e,a)=>(c(),A(we,xe({name:s(v).b()},$e(u)),{default:w(()=>[S(e.$slots,"default")]),_:3},16,["name"]))}});var Ge=W(qe,[["__file","collapse-transition.vue"]]);const Xe=ne(Ge),Ze=ae({title:{type:String,default:""},name:{type:oe([String,Number]),default:void 0},disabled:Boolean}),Je=_=>{const v=Ce(re),{namespace:i}=j("collapse"),u=y(!1),e=y(!1),a=ke(),o=k(()=>a.current++),r=k(()=>{var l;return(l=_.name)!=null?l:`${i.value}-id-${a.prefix}-${s(o)}`}),n=k(()=>v==null?void 0:v.activeNames.value.includes(s(r)));return{focusing:u,id:o,isActive:n,handleFocus:()=>{setTimeout(()=>{e.value?e.value=!1:u.value=!0},50)},handleHeaderClick:()=>{_.disabled||(v==null||v.handleItemClick(s(r)),u.value=!1,e.value=!0)},handleEnterClick:()=>{v==null||v.handleItemClick(s(r))}}},Ye=(_,{focusing:v,isActive:i,id:u})=>{const e=j("collapse"),a=k(()=>[e.b("item"),e.is("active",s(i)),e.is("disabled",_.disabled)]),o=k(()=>[e.be("item","header"),e.is("active",s(i)),{focusing:s(v)&&!_.disabled}]),r=k(()=>[e.be("item","arrow"),e.is("active",s(i))]),n=k(()=>e.be("item","wrap")),m=k(()=>e.be("item","content")),p=k(()=>e.b(`content-${s(u)}`)),d=k(()=>e.b(`head-${s(u)}`));return{arrowKls:r,headKls:o,rootKls:a,itemWrapperKls:n,itemContentKls:m,scopedContentId:p,scopedHeadId:d}},et=T({name:"ElCollapseItem"}),tt=T({...et,props:Ze,setup(_,{expose:v}){const i=_,{focusing:u,id:e,isActive:a,handleFocus:o,handleHeaderClick:r,handleEnterClick:n}=Je(i),{arrowKls:m,headKls:p,rootKls:d,itemWrapperKls:l,itemContentKls:H,scopedContentId:V,scopedHeadId:K}=Ye(i,{focusing:u,isActive:a,id:e});return v({isActive:a}),(D,J)=>(c(),f("div",{class:I(s(d))},[t("button",{id:s(K),class:I(s(p)),"aria-expanded":s(a),"aria-controls":s(V),"aria-describedby":s(V),tabindex:D.disabled?-1:0,type:"button",onClick:s(r),onKeydown:Be(Ne(s(n),["stop","prevent"]),["space","enter"]),onFocus:s(o),onBlur:$=>u.value=!1},[S(D.$slots,"title",{},()=>[x(h(D.title),1)]),C(s(Ee),{class:I(s(m))},{default:w(()=>[C(s(Te))]),_:1},8,["class"])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),C(s(Xe),null,{default:w(()=>[De(t("div",{id:s(V),role:"region",class:I(s(l)),"aria-hidden":!s(a),"aria-labelledby":s(K)},[t("div",{class:I(s(H))},[S(D.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[Ie,s(a)]])]),_:3})],2))}});var ue=W(tt,[["__file","collapse-item.vue"]]);const X=ne(ze,{CollapseItem:ue}),Z=He(ue),st={key:0},at={key:0,class:"text-center"},ot={key:1},lt={class:"flex w-full justify-between px-1 lg:px-2 lg:text-sm"},nt={class:"flex items-center px-2"},it={class:"w-24 phone:w-32"},dt=["src","alt"],ct={class:"ml-4 text-sm lg:text-base"},rt=t("span",{class:"font-bold"},"品項",-1),ut=t("span",{class:"font-bold"},"價錢",-1),mt=t("span",{class:"font-bold"},"時間",-1),pt={key:0,class:"font-bold"},_t=t("span",{class:"font-bold"},"狀態",-1),vt=T({__name:"OrderList",setup(_){const{getImageUrl:v}=ce(),{$firebaseDb:i}=L(),u=i,e=F(),a=y();M(e,n=>{n?a.value=n:a.value=null});const o=y(),r=async n=>{if(n){const m=q(u,"users",n.uid,"orders"),p=await G(m);o.value=p.docs.map(d=>({id:d.id,...d.data()}))}};return N(()=>{a.value&&r(a.value)}),N(()=>{o.value&&(o.value=o.value.sort((n,m)=>{const p=new Date(n.orderTime);return new Date(m.orderTime).getTime()-p.getTime()}))}),(n,m)=>{const p=Z,d=X;return s(o)?(c(),f("div",st,[s(o).length?b("",!0):(c(),f("div",at,"查無已報名活動")),s(o).length?(c(),f("div",ot,[(c(!0),f(z,null,Q(s(o),l=>(c(),f("div",{key:l.id},[C(d,{class:"border-b-2 border-t-0 border-black"},{default:w(()=>[C(p,null,{title:w(()=>[t("div",lt,[t("div",null,h(l.ID),1),t("div",null,h(l.orderTime),1)])]),default:w(()=>[t("div",nt,[t("div",it,[t("img",{src:s(v)(`${l.source}.png`),alt:l.dessert},null,8,dt)]),t("div",ct,[t("div",null,[rt,x(" : "+h(l.dessert),1)]),t("div",null,[ut,x(" : $ "+h(l.price),1)]),t("div",null,[mt,x(" : "+h(l.date)+" "+h(l.time),1)]),l.birthday==="是"?(c(),f("div",pt,"加購生日蛋糕")):b("",!0),t("div",null,[_t,x(" : "+h(l.state),1)])])])]),_:2},1024)]),_:2},1024)]))),128))])):b("",!0)])):b("",!0)}}}),ft={key:0},ht={key:0,class:"text-center"},bt={key:1},gt={class:"flex w-full justify-between px-1 lg:px-2 lg:text-sm"},yt={class:"flex items-center px-2"},xt={class:"w-24 phone:w-32"},$t=["src","alt"],wt={class:"ml-4 text-sm lg:text-base"},Ct=t("span",{class:"font-bold"},"活動",-1),kt=t("span",{class:"font-bold"},"時間",-1),Tt=t("span",{class:"font-bold"},"狀態",-1),Et=T({__name:"ActivityList",setup(_){const{getImageUrl:v}=ce(),{$firebaseDb:i}=L(),u=i,e=F(),a=y();M(e,n=>{n?a.value=n:a.value=null});const o=y(),r=async n=>{if(n){const m=q(u,"users",n.uid,"activities"),p=await G(m);o.value=p.docs.map(d=>({id:d.id,...d.data()}))}};return N(()=>{a.value&&r(a.value)}),N(()=>{o.value&&(o.value=o.value.sort((n,m)=>{const p=new Date(n.orderTime);return new Date(m.orderTime).getTime()-p.getTime()}))}),(n,m)=>{const p=Z,d=X;return s(o)?(c(),f("div",ft,[s(o).length?b("",!0):(c(),f("div",ht,"查無已報名活動")),s(o).length?(c(),f("div",bt,[(c(!0),f(z,null,Q(s(o),l=>(c(),f("div",{key:l.id},[C(d,{class:"border-b-2 border-t-0 border-black"},{default:w(()=>[C(p,null,{title:w(()=>[t("div",gt,[t("div",null,h(l.ID),1),t("div",null,h(l.orderTime),1)])]),default:w(()=>[t("div",yt,[t("div",xt,[t("img",{src:s(v)(`${l.type}.png`),alt:l.name},null,8,$t)]),t("div",wt,[t("div",null,[Ct,x(" : "+h(l.name),1)]),t("div",null,[kt,x(" : "+h(l.date)+" "+h(l.time),1)]),t("div",null,[Tt,x(" : "+h(l.state),1)])])])]),_:2},1024)]),_:2},1024)]))),128))])):b("",!0)])):b("",!0)}}}),Bt={key:0},Nt={key:0,class:"text-center"},Dt={key:1},It={class:"flex w-full justify-between px-1 lg:px-2 lg:text-sm"},Ht={class:"flex items-center px-2"},Vt={class:"ml-4 text-sm lg:text-base"},At=t("span",{class:"font-bold"},"時間",-1),Kt=t("span",{class:"font-bold"},"人數",-1),Pt=t("span",{class:"font-bold"},"時數",-1),Ut=t("span",{class:"font-bold"},"狀態",-1),Ot=T({__name:"RentList",setup(_){const{$firebaseDb:v}=L(),i=v,u=F(),e=y();M(u,r=>{r?e.value=r:e.value=null});const a=y(),o=async r=>{if(r){const n=q(i,"users",r.uid,"rents"),m=await G(n);a.value=m.docs.map(p=>({id:p.id,...p.data()}))}};return N(()=>{e.value&&o(e.value)}),N(()=>{a.value&&(a.value=a.value.sort((r,n)=>{const m=new Date(r.orderTime);return new Date(n.orderTime).getTime()-m.getTime()}))}),(r,n)=>{const m=Z,p=X;return s(a)?(c(),f("div",Bt,[s(a).length?b("",!0):(c(),f("div",Nt,"查無租借訂單")),s(a).length?(c(),f("div",Dt,[(c(!0),f(z,null,Q(s(a),d=>(c(),f("div",{key:d.id},[C(p,{class:"border-b-2 border-t-0 border-black"},{default:w(()=>[C(m,null,{title:w(()=>[t("div",It,[t("div",null,h(d.ID),1),t("div",null,h(d.orderTime),1)])]),default:w(()=>[t("div",Ht,[t("div",Vt,[t("div",null,[At,x(" : "+h(d.date)+" "+h(d.time),1)]),t("div",null,[Kt,x(" : "+h(d.people)+"人",1)]),t("div",null,[Pt,x(" : "+h(d.hours)+"小時",1)]),t("div",null,[Ut,x(" : "+h(d.state),1)])])])]),_:2},1024)]),_:2},1024)]))),128))])):b("",!0)])):b("",!0)}}}),St={key:0,class:"m-auto mb-[150px] px-3 md:w-4/5 lg:max-w-[1000px]"},jt={class:"mt-3 text-center text-2xl font-bold lg:text-start"},Lt={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},Ft={class:"flex justify-between"},Mt=t("div",{class:"text-lg font-bold"},"個人資料",-1),Rt={class:"my-2 flex font-bold"},Wt={class:"mx-3"},zt={class:"my-2 flex font-bold"},Qt={class:"mx-3"},qt={key:0,class:"mr-3 text-red-500"},Gt={class:"my-2 flex font-bold"},Xt={class:"mx-3"},Zt={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},Jt=t("div",{class:"mb-2 flex justify-between"},[t("div",{class:"text-lg font-bold"},"處理中訂單"),t("div",{class:"cursor-pointer"},"訂單管理")],-1),Yt={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},es=t("div",{class:"mb-2 flex justify-between"},[t("div",{class:"text-lg font-bold"},"已報名活動"),t("div",{class:"cursor-pointer"},"活動管理")],-1),ts={class:"m-auto mt-3 rounded-md bg-gray-200 p-2 md:px-5"},ss=t("div",{class:"mb-2 flex justify-between"},[t("div",{class:"text-lg font-bold"},"已預約場地"),t("div",{class:"cursor-pointer"},"租借管理")],-1),rs=T({__name:"user",setup(_){const v=Ve(),{$firebaseDb:i}=L(),u=i,e=F(),a=y();M(e,$=>{$?a.value=$:a.value=null});const o=y(),r=async $=>{if($){const g=await Se(O(u,"users",$.uid));g.exists()&&(o.value=g.data())}},n=y(),m=y(),p=y(),d=y(),l=y(!1),H=y();function V(){o.value.email===a.value.email?H.value=!0:H.value=!1}N(()=>{a.value&&r(a.value)}),le(o,$=>{n.value=$.userName,m.value=$.email,p.value=$.phone,V()});async function K(){await Ae(a.value,{displayName:n.value}),R(O(u,"users",a.value.uid),{userName:n.value}),te({message:"姓名更新成功",type:"success"}),r(a.value)}async function D(){await R(O(u,"users",a.value.uid),{phone:p.value}),te({message:"電話號碼更新成功",type:"success"}),r(a.value)}async function J(){if(a.value)if(m.value===o.value.email)B.alert("新信箱不得與舊信箱相同","提示",{confirmButtonText:"確認"});else{const $=Ke.credential(a.value.email,d.value);try{await Pe(a.value,$),await Ue(a.value,m.value),B.alert("驗證信已成功發送，請查看您的新信箱","提示",{confirmButtonText:"確認"}).then(()=>{R(O(u,"users",a.value.uid),{email:m.value}),B.alert("請在驗證新信箱後再重新登入","提示",{confirmButtonText:"確認"}).then(()=>{Oe(e),v.push({path:"/member"})})}).catch(()=>{})}catch(g){g.code==="auth/missing-password"&&B.alert("密碼不得為空","提示",{confirmButtonText:"確認"}),g.code==="auth/invalid-credential"&&B.alert("密碼錯誤","提示",{confirmButtonText:"確認"}),g.code==="auth/missing-new-email"&&B.alert("信箱不得為空","提示",{confirmButtonText:"確認"}),g.code==="auth/invalid-new-email"&&B.alert("信箱格式錯誤","提示",{confirmButtonText:"確認"})}}}return($,g)=>{var Y;const P=ve,me=vt,pe=Et,_e=Ot;return s(a)?(c(),f("div",St,[t("div",jt,h((Y=s(a))==null?void 0:Y.displayName)+"，歡迎回來 ",1),t("div",Lt,[t("div",Ft,[Mt,s(l)?b("",!0):(c(),f("div",{key:0,class:"cursor-pointer",onClick:g[0]||(g[0]=E=>l.value=!0)},"更改")),s(l)?(c(),f("div",{key:1,class:"cursor-pointer",onClick:g[1]||(g[1]=E=>l.value=!1)},"取消")):b("",!0)]),t("div",Rt,[x(" 名字"),t("span",Wt,h(s(o).userName),1),s(l)?(c(),f("div",{key:0,class:"cursor-pointer",onClick:K},"儲存")):b("",!0)]),s(l)?(c(),A(P,{key:0,modelValue:s(n),"onUpdate:modelValue":g[2]||(g[2]=E=>U(n)?n.value=E:null),placeholder:"名字"},null,8,["modelValue"])):b("",!0),t("div",zt,[x(" 信箱"),t("span",Qt,h(s(o).email),1),s(H)?b("",!0):(c(),f("div",qt,"尚未驗證")),s(l)?(c(),f("div",{key:1,class:"cursor-pointer",onClick:J},"儲存")):b("",!0)]),s(l)?(c(),A(P,{key:1,modelValue:s(m),"onUpdate:modelValue":g[3]||(g[3]=E=>U(m)?m.value=E:null),placeholder:"信箱"},null,8,["modelValue"])):b("",!0),s(l)?(c(),A(P,{key:2,modelValue:s(d),"onUpdate:modelValue":g[4]||(g[4]=E=>U(d)?d.value=E:null),placeholder:"請輸入密碼已進行驗證","show-password":"",class:"mt-1"},null,8,["modelValue"])):b("",!0),t("div",Gt,[x(" 電話"),t("span",Xt,h(s(o).phone),1),s(l)?(c(),f("div",{key:0,class:"cursor-pointer",onClick:D},"儲存")):b("",!0)]),s(l)?(c(),A(P,{key:3,modelValue:s(p),"onUpdate:modelValue":g[5]||(g[5]=E=>U(p)?p.value=E:null),placeholder:"電話"},null,8,["modelValue"])):b("",!0)]),t("div",Zt,[Jt,C(me)]),t("div",Yt,[es,C(pe)]),t("div",ts,[ss,C(_e)])])):b("",!0)}}});export{rs as default};
