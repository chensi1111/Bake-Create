import{u as Z}from"./Bye19Lsi.js";import{u as F}from"./D_RWYVq3.js";import{d as H,a as L,S as O,r as n,T as W,j as D,u as Y,H as q,t as g,v as w,x as t,M as e,y as v,U as d,V as S,W as h,X as _,Y as X,O as G,P as J,aT as $,B as u,Z as K,$ as Q}from"./B_CRW8t7.js";import{n as tt}from"./DP16PUbO.js";const et={class:"px-3"},st={class:"m-auto mt-4 max-w-[1000px] rounded-md bg-pink-100 p-2 shadow-lg lg:px-10"},ot={class:"md:flex"},at={class:"flex overflow-hidden rounded-md md:order-2 md:w-2/5 md:flex-col md:justify-center"},lt={class:"w-1/2 md:w-full"},dt=["src","alt"],nt={class:"flex w-1/2 flex-col justify-center bg-white pl-3 md:w-full"},rt={class:"mb-1 text-lg font-bold md:mt-3 lg:text-xl"},it={class:"font-bold"},ct={class:"font-bold"},ut={class:"mt-3 md:mr-4 md:w-3/5"},mt={class:"mb-2"},pt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),u("姓名")],-1),vt={class:"text-sm text-red-800"},_t={class:"mb-2"},ft=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),u("電話")],-1),ht={class:"text-sm text-red-800"},xt={class:"mb-2"},bt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),u("信箱")],-1),yt={class:"mb-2"},gt=t("div",{class:"font-bold"},"甜點品項",-1),wt=["value"],St={class:"mb-2"},kt=t("div",{class:"font-bold"},"加購生日蛋糕",-1),Ct={class:"mb-2"},Dt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),u("預約日期")],-1),$t={class:"text-sm text-red-800"},Tt={class:"mb-2"},Vt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),u("預約時間")],-1),Pt={class:"text-sm text-red-800"},jt=H({__name:"information",setup(Ut){const{getImageUrl:T}=Z(),l=F(),{$firebaseDb:V}=L(),P=V,U=O(),x=n();W(U,a=>{a?x.value=a:x.value=null});const m=n(l.productName),r=n(),i=n(),c=n(),f=n(),b=n(),A=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,p=n(!1);function N(a){return A.test(a)}const y=D(()=>c.value?N(c.value)?void 0:"請輸入正確格式":"信箱為必填"),k=Y();function M(){k.go(-1)}function R(){if(r.value&&i.value&&!y.value&&f.value){const a=tt(10),s=D(()=>l.birthdayCake?"是":"否"),o=K(P,"users",x.value.uid,"orders",a);Q(o,{name:r.value,phone:i.value,mail:c.value,date:C(f.value),time:b.value,dessert:m.value,birthday:s.value,ID:a,source:l.productSource,price:l.productPrice,orderTime:j(),state:"訂單處理中"}).then(()=>{k.push({path:"/order/complete",query:{name:r.value,phone:i.value,mail:c.value,date:C(f.value),time:b.value,dessert:m.value,birthday:s.value,ID:a}})})}else p.value=!0}q(m,a=>{const s=l.allProducts.find(o=>o.name===a);s&&(l.productName=s.name,l.productPrice=s.price,l.productTime=s.time,l.productSource=s.source)});function j(){const a=new Date,s=a.getFullYear(),o=String(a.getMonth()+1).padStart(2,"0"),z=String(a.getDate()).padStart(2,"0"),B=String(a.getHours()).padStart(2,"0"),E=String(a.getMinutes()).padStart(2,"0"),I=String(a.getSeconds()).padStart(2,"0");return`${s}-${o}-${z}T${B}:${E}:${I}`}function C(a){return new Date(a).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})}return(a,s)=>(g(),w("div",et,[t("div",st,[t("div",ot,[t("div",at,[t("div",lt,[t("img",{src:e(T)(`${e(l).productSource}.png`),alt:e(l).productName},null,8,dt)]),t("div",nt,[t("div",rt,v(e(l).productName),1),t("div",it,"時長 : "+v(e(l).productTime)+"hr",1),t("div",ct,"價格 : $ "+v(e(l).productPrice),1)])]),t("div",ut,[t("div",mt,[pt,d(t("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>h(r)?r.value=o:null),type:"text",placeholder:"請輸入姓名",class:"my-1 w-full py-1 pl-2"},null,512),[[S,e(r)]]),d(t("div",vt,"姓名為必填",512),[[_,!e(r)&&e(p)]])]),t("div",_t,[ft,d(t("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>h(i)?i.value=o:null),type:"text",placeholder:"請輸入電話",class:"my-1 w-full py-1 pl-2"},null,512),[[S,e(i)]]),d(t("div",ht,"電話為必填",512),[[_,!e(i)&&e(p)]])]),t("div",xt,[bt,d(t("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>h(c)?c.value=o:null),type:"text",placeholder:"請輸入信箱",class:"my-1 w-full py-1 pl-2"},null,512),[[S,e(c)]]),d(t("div",{class:"text-sm text-red-800"},v(e(y)),513),[[_,e(y)&&e(p)]])]),t("div",yt,[gt,d(t("select",{"onUpdate:modelValue":s[3]||(s[3]=o=>h(m)?m.value=o:null),class:"my-1 w-full py-1 pl-2"},[(g(!0),w(G,null,J(e(l).allProducts,o=>(g(),w("option",{key:o.name,value:o.name},[t("div",null,v(o.name)+" - $"+v(o.price),1)],8,wt))),128))],512),[[X,e(m)]])]),t("div",St,[kt,t("label",null,[d(t("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>e(l).birthdayCake=o),type:"radio",name:"birthdayCake",value:"true"},null,512),[[$,e(l).birthdayCake]]),u(" 是 ")]),t("label",null,[d(t("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>e(l).birthdayCake=o),type:"radio",name:"birthdayCake",value:"false"},null,512),[[$,e(l).birthdayCake]]),u(" 否 ")])]),t("div",Ct,[Dt,d(t("div",$t,"日期為必填",512),[[_,!e(f)&&e(p)]])]),t("div",Tt,[Vt,d(t("div",Pt,"時間為必填",512),[[_,!e(b)&&e(p)]])])])]),t("div",{class:"flex justify-center"},[t("div",{class:"my-3 mr-4 w-fit cursor-pointer rounded-sm bg-gray-100 px-2 py-1 text-black",onClick:M}," 上一步 "),t("div",{class:"my-3 w-fit cursor-pointer rounded-sm bg-amber-800 px-2 py-1 text-white",onClick:R}," 下一步 ")])])]))}});export{jt as default};
