import{u as E}from"./C5f0-rp9.js";import{u as I}from"./V0rQbDCV.js";import{d as R,a as Z,S as z,r as u,T as F,j as H,u as O,H as Y,t as _,v as h,x as t,M as o,y as d,U as r,V as x,W as p,X as g,Y as q,O as L,P,B as b,Z as W,$ as X}from"./OphSlgzW.js";import{n as G}from"./DP16PUbO.js";const J={class:"px-3"},K={class:"m-auto mt-4 max-w-[1000px] rounded-md bg-pink-100 p-2 shadow-lg lg:px-10"},Q={class:"md:flex"},tt={class:"flex overflow-hidden rounded-md md:order-2 md:w-2/5 md:flex-col md:justify-center"},et={class:"w-1/2 md:w-full"},st=["src","alt"],at={class:"flex w-1/2 flex-col justify-center bg-white pl-3 md:w-full"},ot=t("div",{class:"mb-1 text-lg font-bold md:mt-3 lg:text-xl"},null,-1),it={class:"font-bold"},lt={class:"font-bold"},nt={class:"font-bold"},ct={class:"mt-3 md:mr-4 md:w-3/5"},dt={class:"mb-2"},rt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),b("姓名")],-1),ut={class:"text-sm text-red-800"},mt={class:"mb-2"},vt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),b("電話")],-1),pt={class:"text-sm text-red-800"},yt={class:"mb-2"},ft=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),b("信箱")],-1),_t={class:"mb-2"},ht=t("div",{class:"font-bold"},"活動名稱",-1),xt=["value"],Nt=R({__name:"information",setup(gt){const{getImageUrl:S}=E(),e=I(),{$firebaseDb:D}=Z(),N=D,T=z(),y=u();F(T,s=>{s?y.value=s:y.value=null});const l=u(),n=u(),c=u(),m=u(e.activityName),$=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,v=u(!1);function A(s){return $.test(s)}const f=H(()=>c.value?A(c.value)?void 0:"請輸入正確格式":"信箱為必填"),w=O();function k(){w.go(-1)}function U(){if(l.value&&n.value&&!f.value&&m.value){const s=G(10),a=W(N,"users",y.value.uid,"activities",s);X(a,{name:l.value,phone:n.value,mail:c.value,ID:s,activity:e.activityName,date:e.activityDate,time:e.activityTime,type:e.activitySource,orderTime:V(),state:"報名成功"}).then(()=>{w.push({path:"/activity/signUp/complete",query:{name:l.value,phone:n.value,mail:c.value,ID:s,activity:e.activityName,date:e.activityDate,time:e.activityTime}})})}else v.value=!0}Y(m,s=>{const a=e.activities.find(i=>i.name===s);a&&(e.activityName=a.name,e.activityDate=a.date,e.activityTime=a.time,e.activitySource=a.type)});function V(){const s=new Date,a=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),C=String(s.getDate()).padStart(2,"0"),M=String(s.getHours()).padStart(2,"0"),j=String(s.getMinutes()).padStart(2,"0"),B=String(s.getSeconds()).padStart(2,"0");return`${a}-${i}-${C}T${M}:${j}:${B}`}return(s,a)=>(_(),h("div",J,[t("div",K,[t("div",Q,[t("div",tt,[t("div",et,[t("img",{src:o(S)(`${o(e).activitySource}.png`),alt:o(e).activityName},null,8,st)]),t("div",at,[ot,t("div",it,"活動名稱 :"+d(o(e).activityName),1),t("div",lt,"活動日期 :"+d(o(e).activityDate),1),t("div",nt,"活動時間 :"+d(o(e).activityTime),1)])]),t("div",ct,[t("div",dt,[rt,r(t("input",{"onUpdate:modelValue":a[0]||(a[0]=i=>p(l)?l.value=i:null),type:"text",placeholder:"請輸入姓名",class:"my-1 w-full py-1 pl-2"},null,512),[[x,o(l)]]),r(t("div",ut,"姓名為必填",512),[[g,!o(l)&&o(v)]])]),t("div",mt,[vt,r(t("input",{"onUpdate:modelValue":a[1]||(a[1]=i=>p(n)?n.value=i:null),type:"text",placeholder:"請輸入電話",class:"my-1 w-full py-1 pl-2"},null,512),[[x,o(n)]]),r(t("div",pt,"電話為必填",512),[[g,!o(n)&&o(v)]])]),t("div",yt,[ft,r(t("input",{"onUpdate:modelValue":a[2]||(a[2]=i=>p(c)?c.value=i:null),type:"text",placeholder:"請輸入信箱",class:"my-1 w-full py-1 pl-2"},null,512),[[x,o(c)]]),r(t("div",{class:"text-sm text-red-800"},d(o(f)),513),[[g,o(f)&&o(v)]])]),t("div",_t,[ht,r(t("select",{"onUpdate:modelValue":a[3]||(a[3]=i=>p(m)?m.value=i:null),class:"my-1 w-full py-1 pl-2"},[(_(!0),h(L,null,P(o(e).activitiesNow,i=>(_(),h("option",{key:i.name,value:i.name},[t("div",null,d(i.name)+" - "+d(i.date)+"-"+d(i.time),1)],8,xt))),128))],512),[[q,o(m)]])])])]),t("div",{class:"flex justify-center"},[t("div",{class:"my-3 mr-4 w-fit cursor-pointer rounded-sm bg-gray-100 px-2 py-1 text-black",onClick:k}," 上一步 "),t("div",{class:"my-3 w-fit cursor-pointer rounded-sm bg-amber-800 px-2 py-1 text-white",onClick:U}," 下一步 ")])])]))}});export{Nt as default};
