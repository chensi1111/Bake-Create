import{u as W}from"./BDTCjVus.js";import{u as q}from"./D5L6xSx4.js";import{d as O,a as X,S as G,r as d,T as J,j as T,u as K,H as Q,t as w,v as D,x as t,M as o,y as f,U as n,V as $,W as _,X as y,Y as tt,O as et,P as st,aT as U,B as m,z as M,Z as ot,$ as at}from"./DyyCZs6m.js";import{n as lt}from"./DP16PUbO.js";import{V as P}from"./D2DzkNtv.js";const nt={class:"px-3"},dt={class:"m-auto mt-4 max-w-[1000px] rounded-md bg-pink-100 p-2 shadow-lg lg:px-10"},rt={class:"md:flex"},it={class:"flex overflow-hidden rounded-md md:order-2 md:w-2/5 md:flex-col md:justify-center"},ut={class:"w-1/2 md:w-full"},ct=["src","alt"],mt={class:"flex w-1/2 flex-col justify-center bg-white pl-3 md:w-full"},pt={class:"mb-1 text-lg font-bold md:mt-3 lg:text-xl"},vt={class:"font-bold"},ht={class:"font-bold"},ft={class:"mt-3 md:mr-4 md:w-3/5"},_t={class:"mb-2"},gt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("姓名")],-1),xt={class:"text-sm text-red-800"},yt={class:"mb-2"},bt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("電話")],-1),St={class:"text-sm text-red-800"},wt={class:"mb-2"},Dt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("信箱")],-1),$t={class:"mb-2"},Vt=t("div",{class:"font-bold"},"甜點品項",-1),kt=["value"],Ct={class:"mb-2"},Tt=t("div",{class:"font-bold"},"加購生日蛋糕",-1),Ut={class:"mb-2"},Mt=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("預約日期")],-1),Pt={class:"text-sm text-red-800"},Nt={class:"mb-2"},At=t("div",{class:"font-bold"},[t("span",{class:"text-red-800"},"*"),m("預約時間")],-1),zt={class:"text-sm text-red-800"},Zt=O({__name:"information",setup(Rt){const{getImageUrl:N}=W(),l=q(),{$firebaseDb:A}=X(),z=A,R=G(),b=d();J(R,a=>{a?b.value=a:b.value=null});const p=d(l.productName),r=d(),i=d(),u=d(),c=d(),v=d();function B(){const a=new Date,e=new Date(a);e.setDate(a.getDate()+1);const s=e.getFullYear(),g=String(e.getMonth()+1).padStart(2,"0"),x=String(e.getDate()).padStart(2,"0");return`${s}-${g}-${x}`}function E(){const a=new Date,e=new Date(a);e.setDate(a.getDate()+31);const s=e.getFullYear(),g=String(e.getMonth()+1).padStart(2,"0"),x=String(e.getDate()).padStart(2,"0");return`${s}-${g}-${x}`}const F=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,h=d(!1);function I(a){return F.test(a)}const S=T(()=>u.value?I(u.value)?void 0:"請輸入正確格式":"信箱為必填"),V=K();function Y(){V.go(-1)}function Z(){if(r.value&&i.value&&!S.value&&c.value){const a=lt(10),e=T(()=>l.birthdayCake?"是":"否"),s=ot(z,"users",b.value.uid,"orders",a);at(s,{name:r.value,phone:i.value,mail:u.value,date:k(c.value),time:C(v.value),dessert:p.value,birthday:e.value,ID:a,source:l.productSource,price:l.productPrice,orderTime:j(),state:"訂單處理中"}).then(()=>{V.push({path:"/order/complete",query:{name:r.value,phone:i.value,mail:u.value,date:k(c.value),time:C(v.value),dessert:p.value,birthday:e.value,ID:a}})})}else h.value=!0}Q(p,a=>{const e=l.allProducts.find(s=>s.name===a);e&&(l.productName=e.name,l.productPrice=e.price,l.productTime=e.time,l.productSource=e.source)});function j(){const a=new Date,e=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0"),g=String(a.getDate()).padStart(2,"0"),x=String(a.getHours()).padStart(2,"0"),H=String(a.getMinutes()).padStart(2,"0"),L=String(a.getSeconds()).padStart(2,"0");return`${e}-${s}-${g}T${x}:${H}:${L}`}function k(a){return new Date(a).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"})}function C(a){const e=String(a.hours).padStart(2,"0"),s=String(a.minutes).padStart(2,"0");return`${e}:${s}`}return(a,e)=>(w(),D("div",nt,[t("div",dt,[t("div",rt,[t("div",it,[t("div",ut,[t("img",{src:o(N)(`${o(l).productSource}.png`),alt:o(l).productName},null,8,ct)]),t("div",mt,[t("div",pt,f(o(l).productName),1),t("div",vt,"時長 : "+f(o(l).productTime)+"hr",1),t("div",ht,"價格 : $ "+f(o(l).productPrice),1)])]),t("div",ft,[t("div",_t,[gt,n(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>_(r)?r.value=s:null),type:"text",placeholder:"請輸入姓名",class:"my-1 w-full py-1 pl-2"},null,512),[[$,o(r)]]),n(t("div",xt,"姓名為必填",512),[[y,!o(r)&&o(h)]])]),t("div",yt,[bt,n(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>_(i)?i.value=s:null),type:"text",placeholder:"請輸入電話",class:"my-1 w-full py-1 pl-2"},null,512),[[$,o(i)]]),n(t("div",St,"電話為必填",512),[[y,!o(i)&&o(h)]])]),t("div",wt,[Dt,n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>_(u)?u.value=s:null),type:"text",placeholder:"請輸入信箱",class:"my-1 w-full py-1 pl-2"},null,512),[[$,o(u)]]),n(t("div",{class:"text-sm text-red-800"},f(o(S)),513),[[y,o(S)&&o(h)]])]),t("div",$t,[Vt,n(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>_(p)?p.value=s:null),class:"my-1 w-full py-1 pl-2"},[(w(!0),D(et,null,st(o(l).allProducts,s=>(w(),D("option",{key:s.name,value:s.name},[t("div",null,f(s.name)+" - $"+f(s.price),1)],8,kt))),128))],512),[[tt,o(p)]])]),t("div",Ct,[Tt,t("label",null,[n(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>o(l).birthdayCake=s),type:"radio",name:"birthdayCake",value:"true"},null,512),[[U,o(l).birthdayCake]]),m(" 是 ")]),t("label",null,[n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>o(l).birthdayCake=s),type:"radio",name:"birthdayCake",value:"false"},null,512),[[U,o(l).birthdayCake]]),m(" 否 ")])]),t("div",Ut,[Mt,M(o(P),{modelValue:o(c),"onUpdate:modelValue":e[6]||(e[6]=s=>_(c)?c.value=s:null),"enable-time-picker":!1,"min-date":B(),"max-date":E(),placeholder:"選擇預約日期"},null,8,["modelValue","min-date","max-date"]),n(t("div",Pt,"日期為必填",512),[[y,!o(c)&&o(h)]])]),t("div",Nt,[At,M(o(P),{modelValue:o(v),"onUpdate:modelValue":e[7]||(e[7]=s=>_(v)?v.value=s:null),"time-picker":"","min-time":{hours:7},"max-time":{hours:18},"start-time":{hours:8,minutes:0},"minutes-increment":"15","minutes-grid-increment":"15",placeholder:"選擇預約時間"},null,8,["modelValue"]),n(t("div",zt,"時間為必填",512),[[y,!o(v)&&o(h)]])])])]),t("div",{class:"flex justify-center"},[t("div",{class:"my-3 mr-4 w-fit cursor-pointer rounded-sm bg-gray-100 px-2 py-1 text-black",onClick:Y}," 上一步 "),t("div",{class:"my-3 w-fit cursor-pointer rounded-sm bg-amber-800 px-2 py-1 text-white",onClick:Z}," 下一步 ")])])]))}});export{Zt as default};
